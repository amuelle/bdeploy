<mat-toolbar class="mat-elevation-z1 instance-history_main-toolbar">
  <mat-toolbar-row class="toolbar-row-1st">
    <button mat-icon-button (click)="routingHistoryService.back('instance/overview/'+groupParam+'/'+uuidParam)"> <mat-icon>chevron_left</mat-icon></button>
    <div class="toolbar-title"> <span> Instance: </span><app-instance-group-title [instanceGroup]="groupParam"></app-instance-group-title>/ {{instance? instance.name:""}}</div>

    <mat-menu xPosition="before"  #showMenu="matMenu">
      <button mat-menu-item appClickStopPropagation (click)="showCreate=!showCreate; onTypeFilterChanged()">
        <mat-icon>{{showCreate?'check_box':'check_box_outline_blank'}}</mat-icon> Configuration
      </button>
      <button mat-menu-item appClickStopPropagation (click)="showDeployment=!showDeployment; onTypeFilterChanged()">
        <mat-icon>{{showDeployment?'check_box':'check_box_outline_blank'}}</mat-icon> Deployment
      </button>
      <button mat-menu-item appClickStopPropagation (click)="showRuntime=!showRuntime; onTypeFilterChanged()">
        <mat-icon>{{showRuntime?'check_box':'check_box_outline_blank'}}</mat-icon> Runtime
      </button>
    </mat-menu>

    <div class="compare-versions">
      Compare Versions
      <div>
        <input #compareA class="history-compare-input" (input)="compareInputKeydown($event,0)" />
        <mat-icon>arrow_right_alt</mat-icon>
        <input #compareB class="history-compare-input" (input)="compareInputKeydown($event,1)" />
      </div>
    </div>
    <button #compareButton mat-icon-button matTooltip="Compare versions" matTooltipShowDelay="1000" (click)="compareVersion()" disabled="true">
      <mat-icon>compare_arrows</mat-icon>
    </button>
    <button class="show-filter-button" mat-icon-button [matMenuTriggerFor]="showMenu" matTooltip="Filter Events" matTooltipShowDelay="1000"><mat-icon>filter_list_alt</mat-icon></button>
    <button class="accordionBehaviour-button" matTooltip="Show only one at a time" matTooltipShowDelay="1000" mat-icon-button (click)="accordionBehaviour = !accordionBehaviour; accordionBehaviour? closeAll() : null"><mat-icon color="accent" *ngIf="accordionBehaviour">view_day</mat-icon><mat-icon *ngIf="!accordionBehaviour">view_day</mat-icon></button>
    <button class="close-all-button" mat-icon-button matTooltip="Close all cards" matTooltipShowDelay="1000" [disabled]="accordionBehaviour" (click)="closeAll()"><mat-icon>indeterminate_check_box</mat-icon></button>

    <div class="search-history searchbar">
      <input class="searchbar-input" (keydown.enter)="onTextFilterChanged(searchInput.value)" #searchInput placeholder="Search...">
      <button class="searchbar-button" (click)="onTextFilterChanged(searchInput.value)" mat-icon-button><mat-icon>search</mat-icon></button>
      <div class="searchbar-line"></div> <div class="searchbar-focus-line"></div>
    </div>

  </mat-toolbar-row>
</mat-toolbar>

<div *ngIf="loading" class="loading-spinner">
  <mat-spinner [diameter]="48"></mat-spinner>
</div>

<app-instance-history-timeline [accordion-behaviour]="accordionBehaviour"
  (add-to-comparison)="addVersionToCompare($event)" [entry-list]="history" #timeline (scrolled-down)="onScrolledDown()">
</app-instance-history-timeline>

<div *ngIf="!loading && history.length == 0">
  <div class="not-found">No results found matching the current filter settings.</div>
</div>
