<div class="bd-rect-card local-sizing" fxLayout="column" fxLayoutGap="5px">
  <!-- Logo & Expand Button -->
  <div fxLayout="row" [style.height.px]="100" [style.padding-bottom.px]="14" fxLayoutAlign="center center">
    <div class="local-hamburger-button">
      <div class="hamburger hamburger--arrow" [ngClass]="{ 'is-active': expanded }" (click)="expanded = !expanded">
        <span class="hamburger-box">
          <span class="hamburger-inner"></span>
        </span>
      </div>
    </div>
    <h2
      *ngIf="expanded"
      class="local-header"
      [@delayedFadeIn]="{ value: 'dummy', params: { delay: '0.15s' } }"
      [@delayedFadeOut]="{ value: 'dummy', params: { delay: '0s' } }"
    >
      BDeploy
    </h2>
  </div>

  <!-- Groups -->
  <app-main-nav-button icon="view_carousel" text="Instance Groups" [collapsed]="!expanded" [route]="['/groups/browser']"></app-main-nav-button>

  <app-main-nav-button
    icon="storage"
    *ngIf="!authService.isGlobalExclusiveReadClient()"
    text="Software Repositories"
    [collapsed]="!expanded"
    [route]="['/l/softwarerepo/browser']"
  ></app-main-nav-button>

  <mat-divider [style.position]="'relative'"></mat-divider>

  <app-main-nav-button
    *ngIf="!authService.isScopedExclusiveReadClient(areas.groupContext$ | async)"
    [visible]="!!(areas.groupContext$ | async)"
    icon="settings_system_daydream"
    text="Instances"
    [collapsed]="!expanded"
    [route]="['/instances', 'browser', areas.groupContext$.value]"
  ></app-main-nav-button>

  <app-main-nav-button
    *ngIf="!authService.isScopedExclusiveReadClient(areas.groupContext$ | async)"
    [visible]="!!(areas.groupContext$ | async)"
    icon="apps"
    text="Products"
    [collapsed]="!expanded"
    [route]="['/products', 'browser', areas.groupContext$.value]"
  ></app-main-nav-button>

  <app-main-nav-button
    [visible]="!!(areas.groupContext$ | async)"
    icon="computer"
    text="Client Applications"
    [collapsed]="!expanded"
    [route]="['/groups', 'clients', areas.groupContext$.value]"
  ></app-main-nav-button>

  <app-main-nav-button
    *ngIf="cfgService.isCentral() && !authService.isScopedExclusiveReadClient(areas.groupContext$ | async)"
    [visible]="!!(areas.groupContext$ | async)"
    icon="dns"
    text="Managed Servers"
    [collapsed]="!expanded"
    [route]="['/servers', 'browser', areas.groupContext$.value]"
    [disabled]="!authService.isScopedAdmin(areas.groupContext$ | async)"
    [matTooltip]="authService.isScopedAdmin(areas.groupContext$ | async) ? null : 'Only administrators can maintain managed server configuration'"
    matTooltipPosition="right"
  ></app-main-nav-button>

  <app-main-nav-button
    *ngIf="!authService.isScopedExclusiveReadClient(areas.groupContext$ | async)"
    [visible]="!!(areas.groupContext$ | async)"
    svgIcon="group-settings"
    text="Group Settings"
    [collapsed]="!expanded"
    [panel]="true"
    [route]="['panels', 'groups', 'settings']"
  ></app-main-nav-button>

  <!-- Instance -->

  <mat-divider
    *ngIf="areas.groupContext$ | async"
    [style.position]="'relative'"
    [@delayedFadeIn]="{ value: 'dummy', params: { delay: '0s' } }"
    [@delayedFadeOut]="{ value: 'dummy', params: { delay: '0s' } }"
  ></mat-divider>

  <app-main-nav-button
    [visible]="!!(areas.instanceContext$ | async)"
    icon="dashboard"
    text="Instance Dashboard"
    [collapsed]="!expanded"
    [route]="['/instances', 'dashboard', areas.groupContext$.value, areas.instanceContext$.value]"
  ></app-main-nav-button>

  <app-main-nav-button
    [visible]="!!(areas.instanceContext$ | async)"
    svgIcon="instance-settings"
    text="Instance Configuration"
    [collapsed]="!expanded"
    [route]="['/instances', 'configuration', areas.groupContext$.value, areas.instanceContext$.value]"
    [disabled]="!authService.isScopedWrite(areas.groupContext$ | async)"
    [matTooltip]="authService.isScopedWrite(areas.groupContext$ | async) ? null : 'Insufficient permissions to change configuration'"
    matTooltipPosition="right"
  ></app-main-nav-button>

  <app-main-nav-button
    [visible]="!!(areas.instanceContext$ | async)"
    icon="source"
    text="Data Files"
    [collapsed]="!expanded"
    [route]="['/instances', 'data-files', areas.groupContext$.value, areas.instanceContext$.value]"
  ></app-main-nav-button>

  <app-main-nav-button
    [visible]="!!(areas.instanceContext$ | async)"
    icon="history"
    text="Instance History"
    [collapsed]="!expanded"
    [route]="['/instances', 'history', areas.groupContext$.value, areas.instanceContext$.value]"
  ></app-main-nav-button>

  <!-- Footer -->
  <div fxFlex="1 0 auto"></div>
  <div *ngIf="!expanded" class="local-server-type" [@delayedFadeIn]="{ value: 'dummy', params: { delay: '0.5s' } }">
    {{ cfgService.config.mode }}
  </div>
  <div fxLayout="column" fxLayoutGap="5px" *ngIf="expanded" class="local-footer" [@delayedFadeIn]="{ value: 'dummy', params: { delay: '0.15s' } }">
    <app-bd-button
      *ngIf="authService.isGlobalAdmin()"
      fxFlexAlign="center center"
      icon="settings"
      text="Administration"
      color="toolbar"
      [collapsed]="!expanded"
      [routerLink]="['/admin/']"
    ></app-bd-button>
    <a href="/assets/doc/index.html" target="_blank" class="bd-button-link">
      <app-bd-button fxFlexAlign="center center" icon="help_outline" text="Help" color="toolbar" [collapsed]="!expanded"></app-bd-button>
    </a>
    <mat-divider class="local-footer-divider"></mat-divider>
    <div gdColumns="auto auto" gdGap="5px">
      <span>Version:</span>
      <span>{{ cfgService?.config?.version | formatVersion }}</span>

      <span>Mode:</span>
      <span>{{ cfgService?.config?.mode }}</span>

      <span>Log Level:</span>
      <mat-select [value]="getLogLevel()" (selectionChange)="setLogLevel($event)">
        <mat-option value="0">Error</mat-option>
        <mat-option value="1">Warning</mat-option>
        <mat-option value="2">Info</mat-option>
        <mat-option value="3">Debug</mat-option>
        <mat-option value="4">Trace</mat-option>
      </mat-select>
    </div>
  </div>
</div>
